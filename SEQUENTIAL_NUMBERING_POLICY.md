# ๐ข ุณูุงุณุฉ ุงูุชุฑููู ุงููุชุณูุณู ุงูุนุงููู - Sequential Global Numbering Policy

## ๐ ูุธุฑุฉ ุนุงูุฉ / Overview

ุชู ุชุทุจูู ุณูุงุณุฉ ุชุฑููู ูุชุณูุณู ุนุงููู ูุฌููุน ุงููุญุฏุงุช ุงูุณูููุฉ ูู ุงููุธุงู. ุฌููุน ุงููุญุฏุงุช ูุฑููุฉ ูู **1 ุฅูู N** ุจุดูู ูุชุณูุณู ุนุจุฑ ุฌููุน ุงูุฃุฏูุงุฑ ุจุฏูู ูุฌูุงุช ุฃู ุฃุฑูุงู ููุฑุฑุฉ.

**Sequential global numbering policy has been applied to all units. All units are numbered from 1 to N sequentially across all floors with no gaps or duplicate numbers.**

---

## ๐ฏ ุงููุจุงุฏุฆ ุงูุฃุณุงุณูุฉ / Core Principles

| ุงููุจุฏุฃ | ุงููุตู |
|--------|-------|
| **ูุชุณูุณู** | ุงูุฃุฑูุงู ุชุจุฏุฃ ูู 1 ูุชุฒุฏุงุฏ ุจููุฏุงุฑ 1 ููู ูุญุฏุฉ |
| **ุนุงููู** | ุงูุชุฑููู ููุญุฏ ุนุจุฑ ุฌููุน ุงูุฃุฏูุงุฑ ูู ุงูุนูุงุฑุฉ |
| **ูุง ุชูุฑุงุฑ** | ูุง ุชูุฌุฏ ุฃุฑูุงู ููุฑุฑุฉ ุนูู ุงูุฅุทูุงู |
| **ูุง ูุฌูุงุช** | ูุง ุชูุฌุฏ ูุฌูุงุช ูู ุงูุชุฑููู |
| **ูุถููู** | ูุชู ุงูุชุญูู ูุงูุฅุตูุงุญ ุงูุชููุงุฆู ูุจู ุงูุญูุธ |

---

## ๐ ุงูุนูููุงุช ุงููุทุจูุฉ ุนูููุง / Applied Operations

### โ ุนูููุงุช ุชุทุจู ุงูุชุฑููู ุงููุชุณูุณู

#### 1. ุฅุถุงูุฉ ุฏูุฑ ุฌุฏูุฏ
```tsx
addFloor() โ ูุชู ุฅุนุงุฏุฉ ุชุฑููู ุฌููุน ุงููุญุฏุงุช
```
- ุนูุฏ ุฅุถุงูุฉ ุฏูุฑ ุฌุฏูุฏุ ุชูุนุงุฏ ุชุฑููู ุฌููุน ุงููุญุฏุงุช ุจุดูู ูุชุณูุณู
- ุงูุฏูุฑ ุงูุฌุฏูุฏ ูุญุตู ุนูู ุฃุนูู ุฑูู ุฏูุฑ

#### 2. ุญุฐู ุฏูุฑ
```tsx
removeFloor(floorNumber) โ ุฅุนุงุฏุฉ ุชุฑููู ูุงููุฉ
```
- ุฅุฒุงูุฉ ุงูุฏูุฑ ูู ุงููุงุฆูุฉ
- ุฅุนุงุฏุฉ ุชุฑููู ุงูุฃุฏูุงุฑ ูู 1
- ุฅุนุงุฏุฉ ุชุฑููู ุฌููุน ุงููุญุฏุงุช ุจุดูู ูุชุณูุณู

#### 3. ุฅุถุงูุฉ ูุญุฏุฉ
```tsx
addUnit(floorNumber) โ ุฅุนุงุฏุฉ ุชุฑููู ูุชุณูุณู
```
- ุฅุถุงูุฉ ูุญุฏุฉ ุฌุฏูุฏุฉ ุฅูู ุฏูุฑ ูุญุฏุฏ
- ุฌููุน ุงููุญุฏุงุช ุชูุนุงุฏ ุชุฑููููุง ุจุดูู ูุชุณูุณู

#### 4. ุญุฐู ูุญุฏุฉ
```tsx
removeUnit(floorNumber, unitIndex) โ ุฅุนุงุฏุฉ ุชุฑููู ูุชุณูุณู
```
- ุญุฐู ุงููุญุฏุฉ ูู ุงูุฏูุฑ
- ุฌููุน ุงููุญุฏุงุช ุชูุนุงุฏ ุชุฑููููุง ุจุฏุงูุฉ ูู 1

#### 5. ุชุบููุฑ ูุธุงู ุงูุฏูุฑ
```tsx
updateFloorPlan(floorNumber, plan) โ ุฅุนุงุฏุฉ ุชุฑููู ูุชุณูุณู
```
- ุชุบููุฑ ุนุฏุฏ ุงููุญุฏุงุช ูู ุงูุฏูุฑ (4shuqq โ 3shuqq)
- ุฅุนุงุฏุฉ ุชุฑููู ุฌููุน ุงููุญุฏุงุช ูู ุฌููุน ุงูุฃุฏูุงุฑ

#### 6. ูุณุฎ ุงูุฏูุฑ ูุฌููุน ุงูุฃุฏูุงุฑ
```tsx
copyFloorToAll(sourceFloorNumber) โ ุฅุนุงุฏุฉ ุชุฑููู ูุชุณูุณู
```
- ูุณุฎ ูููุฐุฌ ุงูุฏูุฑ ุฅูู ุฌููุน ุงูุฃุฏูุงุฑ ุงูุฃุฎุฑู
- ุฅุนุงุฏุฉ ุชุฑููู ุฌููุน ุงููุญุฏุงุช ุจุดูู ููุญุฏ

---

## ๐พ ุณูุงุณุฉ ุงูุญูุธ ูู Supabase / Supabase Save Policy

### ุงููุฑุงุญู ูุจู ุงูุญูุธ:

#### 0๏ธโฃ ุชุทุจูู ุณูุงุณุฉ ุงูุชุฑููู (ุฌุฏูุฏ)
```tsx
const floorsWithSequentialNumbers = ensureSequentialNumbering()
```
- ุฏุงูุฉ ุฌุฏูุฏุฉ ุชุถูู ุฃุฑูุงู ูุชุณูุณูุฉ ูุจู ุงูุญูุธ
- ุชูุทุจู ุงูุชุตุญูุญ ุงูุชููุงุฆู ููุฃุฑูุงู ุงูููุฑุฑุฉ ุฃู ุงููุงุฑุบุฉ

#### 1๏ธโฃ ุงูุชุญูู ูู ุงููุณุชุฎุฏู
- ุงูุชุฃูุฏ ูู ุชุณุฌูู ุฏุฎูู ุงููุณุชุฎุฏู

#### 2๏ธโฃ ุงูุชุญูู ูู ุงูุจูุงูุงุช
- ุงูุชุญูู ูู ุงุณู ุงูุนูุงุฑุฉ
- ุงูุชุญูู ูู ุนุฏู ูุฌูุฏ ุฃุฑูุงู ููุฑุฑุฉ
- ุงูุชุญูู ูู ุนุฏู ูุฌูุฏ ุฃุฑูุงู ูุงุฑุบุฉ

#### 3๏ธโฃ ุญูุธ ุจููุงุช ุงูุนูุงุฑุฉ
- ุงุณุชุฎุฏุงู `floorsWithSequentialNumbers`
- ุญูุธ `total_units` ู `total_floors` ุงูุฏูููุฉ

#### 4๏ธโฃ ุฑูุน ุงูุตูุฑ (ุงุฎุชูุงุฑู)

#### 5๏ธโฃ ุญูุธ ุงููุญุฏุงุช
- **ุงุณุชุฎุฏุงู `floorsWithSequentialNumbers` ููุท**
- ูู ูุญุฏุฉ ุชูุญูุธ ุจุฑูู ูุชุณูุณู ูุถููู
- ุญูุธ ูู ุฌุฏูู `units` ูุน ุงูุญููู ูุงููุฉ

---

## ๐ ุงูุชุญูู ูู ุงูุจูุงูุงุช / Data Validation

### ูุจู ุงูุญูุธ:
```tsx
// 1๏ธโฃ ุงูุชุญูู ูู ุงูุฃุฑูุงู ุงููุงุฑุบุฉ
if (!unit.unitNumber || unit.unitNumber.trim() === '') {
  throw new Error('ูุญุฏุฉ ุจุฏูู ุฑูู')
}

// 2๏ธโฃ ุงูุชุญูู ูู ุงูุฃุฑูุงู ุงูููุฑุฑุฉ
const duplicateNumbers = findDuplicates(unitNumbers)
if (duplicateNumbers.length > 0) {
  throw new Error(`ุฃุฑูุงู ููุฑุฑุฉ: ${duplicateNumbers}`)
}

// 3๏ธโฃ ุงูุชุญูู ูู ุงูุชุณูุณู
const numbers = units.map(u => parseInt(u.unitNumber))
if (!isSequential(numbers)) {
  throw new Error('ุฃุฑูุงู ุบูุฑ ูุชุณูุณูุฉ')
}
```

---

## ๐ ูุซุงู ุนููู / Practical Example

### ุงูุณููุงุฑูู:
- ุนูุงุฑุฉ ุจู 3 ุฃุฏูุงุฑ
- ุงูุฏูุฑ 1: 4 ูุญุฏุงุช
- ุงูุฏูุฑ 2: 3 ูุญุฏุงุช
- ุงูุฏูุฑ 3: 2 ูุญุฏุฉ

### ุงูุชุฑููู:
```
ุงูุฏูุฑ 1: [ 1, 2, 3, 4 ]
ุงูุฏูุฑ 2: [ 5, 6, 7 ]
ุงูุฏูุฑ 3: [ 8, 9 ]
```

### ุจุนุฏ ุญุฐู ูุญุฏุฉ ูู ุงูุฏูุฑ 1:
```
ุงูุฏูุฑ 1: [ 1, 2, 3 ]
ุงูุฏูุฑ 2: [ 4, 5, 6 ]
ุงูุฏูุฑ 3: [ 7, 8 ]
```

---

## ๐ ุงูุญูุงูุฉ ูู ุงูุฃุฎุทุงุก / Error Prevention

### 1๏ธโฃ ุงููุญุต ุงูุชููุงุฆู ูุจู ุงูุญูุธ
```tsx
ensureSequentialNumbering() {
  let num = 1
  return floors.map(floor => ({
    ...floor,
    units: floor.units.map(unit => ({
      ...unit,
      unitNumber: String(num++)
    }))
  }))
}
```

### 2๏ธโฃ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงููุชูุฏูุฉ
| ููุน ุงูุฎุทุฃ | ุงูุญู |
|----------|------|
| ุฃุฑูุงู ูุงุฑุบุฉ | ุชู ุงูุฅุตูุงุญ ุชููุงุฆูุงู | 
| ุฃุฑูุงู ููุฑุฑุฉ | ุชู ุฅุนุงุฏุฉ ุชุฑููููุง |
| ูุฌูุงุช ูู ุงูุชุณูุณู | ุชู ุณุฏูุง ุชููุงุฆูุงู |
| ุฃุฎุทุงุก RLS | ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ ูุน ุงูุญู |

---

## ๐ ุฑุณุงุฆู ุงูุณุฌู / Console Messages

### ุนูุฏ ุงูุญูุธ ูุชู ุทุจุงุนุฉ:
```
๐ข ุชู ุชุทุจูู ุณูุงุณุฉ ุงูุชุฑููู ุงููุชุณูุณู:
   - ุฅุฌูุงูู ุงููุญุฏุงุช: 9
   - ุฃูู ูุญุฏุฉ: 1
   - ุขุฎุฑ ูุญุฏุฉ: 9

๐ข ุจุฏุก ุญูุธ 9 ูุญุฏุฉ ุณูููุฉ ุจุฑูู ูุชุณูุณู ูุถููู...
   ๐ ุญูุธ ูุญุฏุฉ ุฑูู: 1 ูู ุงูุฏูุฑ 1
   โ ุชู ุญูุธ ุงููุญุฏุฉ 1 ุจูุฌุงุญ
   ...
   
๐ฏ ููุฎุต ุงูุญูุธ: ุชู ุญูุธ 9 ูุญุฏุฉ ุจุฑูู ูุชุณูุณู ุตุญูุญ (1 ุฅูู 9)
```

---

## ๐ ุงูุฎุทูุงุช ุงููุงุฏูุฉ / Next Steps

### ููุตูุงูุฉ ุงูุฏูุฑูุฉ:
1. โ ุงูุชุญูู ูู ุฌุฏูู `units` ูู Supabase
2. โ ุงูุชุฃูุฏ ูู ูุฌูุฏ ุนููุฏ `unit_number` ูุญุฏุซ
3. โ ุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุจู ุฃู ุชุญุฏูุซุงุช ูุจูุฑุฉ

### ููุชุทููุฑ ุงููุณุชูุจูู:
1. โณ ุฅุถุงูุฉ Query ูุฅุนุงุฏุฉ ุชุฑููู ุงููุญุฏุงุช ุงูููุฌูุฏุฉ
2. โณ ุฅุถุงูุฉ Trigger ูู Supabase ููุชุญูู ุงูุชููุงุฆู
3. โณ ุฅุถุงูุฉ ุตูุญุฉ ุฅุฏุงุฑุฉ ูุฅุนุงุฏุฉ ุชุฑููู ูุฏููุฉ ุฅู ูุฒู

### ูููุงุฌูุฉ ุงูุฃูุงููุฉ:
1. โ ุนุฑุถ ุฃุฑูุงู ุงููุญุฏุงุช ุจูุถูุญ
2. โ ุชุญุฏูุซ ุงูุจูุงูุงุช ูู ุงูููุช ุงููุนูู
3. โณ ุฅุถุงูุฉ ุฒุฑ "ุงูุชุญูู ูู ุงูุชุฑููู" ูู ุตูุญุฉ ุงูุชุญุฑูุฑ

---

## ๐ ุฏุนู ูุชูุซูู / Support & Documentation

### ุงููููุงุช ุฐุงุช ุงูุตูุฉ:
- [src/app/dashboard/buildings/new/page.tsx](src/app/dashboard/buildings/new/page.tsx) - ุงูููุทู ุงูุฃุณุงุณู
- [COMPLETE_SAVE_GUIDE.md](COMPLETE_SAVE_GUIDE.md) - ุฏููู ุงูุญูุธ ุงููุงูู
- [UPDATE_SUMMARY.md](UPDATE_SUMMARY.md) - ููุฎุต ุงูุชุญุฏูุซุงุช

### ูููุฒูุฏ ูู ุงููุนูููุงุช:
- ุชุงุฑูุฎ ุงูุชุทุจูู: 17 ูุจุฑุงูุฑ 2026
- ุขุฎุฑ ุชุญุฏูุซ: 2026-02-17
- ุงูุญุงูุฉ: โ ูุทุจู ูุขูู
- ุงูุงุฎุชุจุงุฑ: โ ูุฏูู ููุคูุฏ

---

## โ ูุงุฆูุฉ ุงูุชุญูู / Checklist

- [x] ุชุทุจูู ุงูุชุฑููู ุงููุชุณูุณู ูู ุงูู Frontend
- [x] ุชุทุจูู ุงูุชุฑููู ุงููุชุณูุณู ูู ุฌููุน ุงูุนูููุงุช
- [x] ุฅุถุงูุฉ ุฏุงูุฉ `ensureSequentialNumbering()`
- [x] ุชุญุฏูุซ `confirmSaveBuilding()` ูุงุณุชุฎุฏุงู ุงูุณูุงุณุฉ
- [x] ุฅุถุงูุฉ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงููุชูุฏูุฉ
- [x] ุฅุถุงูุฉ ุฑุณุงุฆู ุณุฌู ููุตูุฉ
- [x] ุงุฎุชุจุงุฑ ุงูู Build
- [x] ุนูู Commit ูุน ุฑุณุงูุฉ ูุงุถุญุฉ
- [x] ุชูุซูู ุงูุณูุงุณุฉ
- [ ] ุงุฎุชุจุงุฑ ุดุงูู ูู ุงูุจูุฆุฉ ุงูุญูุฉ
- [ ] ุชุฏุฑูุจ ุงููุฑูู ุนูู ุงูุณูุงุณุฉ ุงูุฌุฏูุฏุฉ

---

**ุขุฎุฑ ุชุญุฏูุซ: 17 ูุจุฑุงูุฑ 2026** โ
